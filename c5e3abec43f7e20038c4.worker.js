!function(e){var t=this.webpackHotUpdate;this.webpackHotUpdate=function(e,n){!function(e,t){if(!E[e]||!w[e])return;for(var n in w[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(g[n]=t[n]);0==--m&&0===b&&T()}(e,n),t&&t(e,n)};var n,r=!0,i="c5e3abec43f7e20038c4",o=1e4,s={},a=[],l=[];function p(e){var t=D[e];if(!t)return O;var r=function(r){return t.hot.active?(D[r]?-1===D[r].parents.indexOf(e)&&D[r].parents.push(e):(a=[e],n=r),-1===t.children.indexOf(r)&&t.children.push(r)):(console.warn("[HMR] unexpected require("+r+") from disposed module "+e),a=[]),O(r)},i=function(e){return{configurable:!0,enumerable:!0,get:function(){return O[e]},set:function(t){O[e]=t}}};for(var o in O)Object.prototype.hasOwnProperty.call(O,o)&&"e"!==o&&"t"!==o&&Object.defineProperty(r,o,i(o));return r.e=function(e){return"ready"===h&&u("prepare"),b++,O.e(e).then(t,function(e){throw t(),e});function t(){b--,"prepare"===h&&(v[e]||k(e),0===b&&0===m&&T())}},r.t=function(e,t){return 1&t&&(e=r(e)),O.t(e,-2&t)},r}function d(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:n!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var r=0;r<e.length;r++)t._acceptedDependencies[e[r]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:P,apply:M,status:function(e){if(!e)return h;c.push(e)},addStatusHandler:function(e){c.push(e)},removeStatusHandler:function(e){var t=c.indexOf(e);t>=0&&c.splice(t,1)},data:s[e]};return n=void 0,t}var c=[],h="idle";function u(e){h=e;for(var t=0;t<c.length;t++)c[t].call(null,e)}var f,g,y,m=0,b=0,v={},w={},E={};function S(e){return+e+""===e?+e:e}function P(e){if("idle"!==h)throw new Error("check() is only allowed in idle status");return r=e,u("check"),(t=o,t=t||1e4,new Promise(function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var r=new XMLHttpRequest,o=O.p+""+i+".hot-update.json";r.open("GET",o,!0),r.timeout=t,r.send(null)}catch(e){return n(e)}r.onreadystatechange=function(){if(4===r.readyState)if(0===r.status)n(new Error("Manifest request to "+o+" timed out."));else if(404===r.status)e();else if(200!==r.status&&304!==r.status)n(new Error("Manifest request to "+o+" failed."));else{try{var t=JSON.parse(r.responseText)}catch(e){return void n(e)}e(t)}}})).then(function(e){if(!e)return u("idle"),null;w={},v={},E=e.c,y=e.h,u("prepare");var t=new Promise(function(e,t){f={resolve:e,reject:t}});g={};return k(0),"prepare"===h&&0===b&&0===m&&T(),t});var t}function k(e){E[e]?(w[e]=!0,m++,function(e){importScripts(O.p+""+e+"."+i+".hot-update.js")}(e)):v[e]=!0}function T(){u("ready");var e=f;if(f=null,e)if(r)Promise.resolve().then(function(){return M(r)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&t.push(S(n));e.resolve(t)}}function M(t){if("ready"!==h)throw new Error("apply() is only allowed in ready status");var n,r,o,l,p;function d(e){for(var t=[e],n={},r=t.slice().map(function(e){return{chain:[e],id:e}});r.length>0;){var i=r.pop(),o=i.id,s=i.chain;if((l=D[o])&&!l.hot._selfAccepted){if(l.hot._selfDeclined)return{type:"self-declined",chain:s,moduleId:o};if(l.hot._main)return{type:"unaccepted",chain:s,moduleId:o};for(var a=0;a<l.parents.length;a++){var p=l.parents[a],d=D[p];if(d){if(d.hot._declinedDependencies[o])return{type:"declined",chain:s.concat([p]),moduleId:o,parentId:p};-1===t.indexOf(p)&&(d.hot._acceptedDependencies[o]?(n[p]||(n[p]=[]),c(n[p],[o])):(delete n[p],t.push(p),r.push({chain:s.concat([p]),id:p})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];-1===e.indexOf(r)&&e.push(r)}}t=t||{};var f={},m=[],b={},v=function(){console.warn("[HMR] unexpected require("+P.moduleId+") to disposed module")};for(var w in g)if(Object.prototype.hasOwnProperty.call(g,w)){var P;p=S(w);var k=!1,T=!1,M=!1,x="";switch((P=g[w]?d(p):{type:"disposed",moduleId:w}).chain&&(x="\nUpdate propagation: "+P.chain.join(" -> ")),P.type){case"self-declined":t.onDeclined&&t.onDeclined(P),t.ignoreDeclined||(k=new Error("Aborted because of self decline: "+P.moduleId+x));break;case"declined":t.onDeclined&&t.onDeclined(P),t.ignoreDeclined||(k=new Error("Aborted because of declined dependency: "+P.moduleId+" in "+P.parentId+x));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(P),t.ignoreUnaccepted||(k=new Error("Aborted because "+p+" is not accepted"+x));break;case"accepted":t.onAccepted&&t.onAccepted(P),T=!0;break;case"disposed":t.onDisposed&&t.onDisposed(P),M=!0;break;default:throw new Error("Unexception type "+P.type)}if(k)return u("abort"),Promise.reject(k);if(T)for(p in b[p]=g[p],c(m,P.outdatedModules),P.outdatedDependencies)Object.prototype.hasOwnProperty.call(P.outdatedDependencies,p)&&(f[p]||(f[p]=[]),c(f[p],P.outdatedDependencies[p]));M&&(c(m,[P.moduleId]),b[p]=v)}var A,C=[];for(r=0;r<m.length;r++)p=m[r],D[p]&&D[p].hot._selfAccepted&&C.push({module:p,errorHandler:D[p].hot._selfAccepted});u("dispose"),Object.keys(E).forEach(function(e){!1===E[e]&&function(e){delete installedChunks[e]}(e)});for(var I,j,_=m.slice();_.length>0;)if(p=_.pop(),l=D[p]){var F={},H=l.hot._disposeHandlers;for(o=0;o<H.length;o++)(n=H[o])(F);for(s[p]=F,l.hot.active=!1,delete D[p],delete f[p],o=0;o<l.children.length;o++){var K=D[l.children[o]];K&&((A=K.parents.indexOf(p))>=0&&K.parents.splice(A,1))}}for(p in f)if(Object.prototype.hasOwnProperty.call(f,p)&&(l=D[p]))for(j=f[p],o=0;o<j.length;o++)I=j[o],(A=l.children.indexOf(I))>=0&&l.children.splice(A,1);for(p in u("apply"),i=y,b)Object.prototype.hasOwnProperty.call(b,p)&&(e[p]=b[p]);var R=null;for(p in f)if(Object.prototype.hasOwnProperty.call(f,p)&&(l=D[p])){j=f[p];var N=[];for(r=0;r<j.length;r++)if(I=j[r],n=l.hot._acceptedDependencies[I]){if(-1!==N.indexOf(n))continue;N.push(n)}for(r=0;r<N.length;r++){n=N[r];try{n(j)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:p,dependencyId:j[r],error:e}),t.ignoreErrored||R||(R=e)}}}for(r=0;r<C.length;r++){var B=C[r];p=B.module,a=[p];try{O(p)}catch(e){if("function"==typeof B.errorHandler)try{B.errorHandler(e)}catch(n){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:p,error:n,originalError:e}),t.ignoreErrored||R||(R=n),R||(R=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:p,error:e}),t.ignoreErrored||R||(R=e)}}return R?(u("fail"),Promise.reject(R)):(u("idle"),new Promise(function(e){e(m)}))}var D={};function O(t){if(D[t])return D[t].exports;var n=D[t]={i:t,l:!1,exports:{},hot:d(t),parents:(l=a,a=[],l),children:[]};return e[t].call(n.exports,n,n.exports,p(t)),n.l=!0,n.exports}O.m=e,O.c=D,O.d=function(e,t,n){O.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},O.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},O.t=function(e,t){if(1&t&&(e=O(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(O.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)O.d(n,r,function(t){return e[t]}.bind(null,r));return n},O.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return O.d(t,"a",t),t},O.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},O.p="",O.h=function(){return i},p("./src/webworkers/pulse.worker.js")(O.s="./src/webworkers/pulse.worker.js")}({"./src/webworkers/pulse.worker.js":function(e,t,n){"use strict";n.r(t);class r{constructor(){this.eventsStore=new Map,this.elementsMap=new Map,this.customEventTypes=new Set,this.onAddElementActionsMap=new Map,this.exhaustTypesMap=new Map,this.routine={interpretTarget:e=>e},this.propagationKey=Symbol("propagationKey"),this.nullKey=Symbol("@@eventswork/nullKey"),this.parentKey=Symbol("@@eventswork/parentKey"),this.addElementEventType=Symbol("@@addElement"),this.registerEventType(this.addElementEventType),this.RoleSet=this.invokeRoleSetClass(),this.worker=new this.RoleSet([]),this.fireFromQueueType=Symbol("@@eventswork/fireFromQueue"),this.fireFromQueueId=Symbol("@@eventswork/fireFromQueueId"),this.queueData=[],this.countTypesInQueue=new Map,this.worker.name="@@worker",this.eventChain({roleSet:this.worker,type:this.fireFromQueueType,action:()=>{if(this.queueData.length>0){const{target:e,type:t,event:n}=this.queueData.shift();this.fireEvent(e,t,n);const r=this.countTypesInQueue.get(t)-1;0===r&&this.exhaustTypesMap.has(t)&&(this.exhaustTypesMap.get(t)(t),this.exhaustTypesMap.delete(t)),this.countTypesInQueue.set(t,r),Promise.resolve().then(()=>this.getCallback({[this.nullKey]:!0,[this.parentKey]:this.worker},this.fireFromQueueType)())}}},this.fireFromQueueId),this.defineRoutine=this.defineRoutine.bind(this),this.managePropagation=this.managePropagation.bind(this),this.stopBubbling=this.stopBubbling.bind(this),this.stopPropagatingNested=this.stopPropagatingNested.bind(this),this.setActionOnAddElement=this.setActionOnAddElement.bind(this),this.fireEvent=this.fireEvent.bind(this),this.eventChain=this.eventChain.bind(this),this.waitWhenTypeExhausted=this.waitWhenTypeExhausted.bind(this)}static getSomeFromDeep(e,t,n){let r;return(r=e instanceof Map?e.get(t):e[t])||(r=n(),e instanceof Map?e.set(t,r):e[t]=r),r}static getFromDeepMap(e,t){const n=r.getSomeFromDeep(e,t,()=>new Map);return{map:n,next:r.getFromDeepMap.bind(null,n)}}defineRoutine({interpretTarget:e,defaultPropagation:t}){Object.assign(this.routine,{interpretTarget:e,defaultPropagation:t})}registerEventType(e){this.customEventTypes.add(e)}managePropagation(e,t){const{stopBubbling:n,stopPropagatingNested:r}=t;return e[this.propagationKey]||(e[this.propagationKey]={}),Object.assign(e[this.propagationKey],{stopBubbling:n?new Set:null,stopPropagatingNested:r}),e}stopBubbling(e={}){return this.managePropagation(e,{stopBubbling:!0}),e.stopPropagatingNested=this.stopPropagatingNested.bind(null,e),e}stopPropagatingNested(e={}){return this.managePropagation(e,{stopPropagatingNested:!0}),e.stopBubbling=this.stopBubbling.bind(null,e),e}applyDefaultPropagation(e){if(!e[this.propagationKey]){e[this.propagationKey]={};const{defaultPropagation:t}=this.routine;t&&this.managePropagation(e,t)}return e}getCallback(e,t){const n=(e,t,i,o)=>{let s=o;o||(s=e[this.parentKey]||this.elementsMap.get(e).belong);const a=r.getFromDeepMap(this.eventsStore,s).map;a.has(t)&&[...a.get(t).entries()].forEach(n=>{const[r,o]=n;o({target:e,roleSet:e[this.parentKey]||this.elementsMap.get(e).belong,type:t,event:i,eventID:r})});const l=this.elementsMap.get(s);l&&n(e,t,i,l.belong)};return(r={})=>{n(e,t,this.applyDefaultPropagation(r))}}addCallback(e,t){const n=this.elementsMap.get(e),i=r.getSomeFromDeep(n,"types",()=>new Set);i.has(t)||(this.routine.interpretTarget(e)&&this.routine.interpretTarget(e).addEventListener(t,this.getCallback(e,t)),i.add(t))}addCallbackToChildren(e,t){if(e.size>0){0===r.getFromDeepMap(this.eventsStore,e).next(t).map.size&&[...e].forEach(e=>{e instanceof this.RoleSet?this.addCallbackToChildren(e,t):this.addCallback(e,t)})}}combineTypes(e,t=[]){let n=t.concat([...r.getFromDeepMap(this.eventsStore,e).map.keys()].filter(e=>"string"==typeof e));const i=this.elementsMap.get(e);return i&&(n=this.combineTypes(i.belong,n)),n}invokeRoleSetClass(){const e=this;return class t extends Set{constructor(t){super(t),t&&t.forEach(t=>{e.elementsMap.set(t,{belong:this})}),e.onAddElementActionsMap.set(this,()=>{}),e.eventChain({roleSet:this,type:e.addElementEventType,action:(...t)=>{e.onAddElementActionsMap.get(this)(...t)}},Symbol("@@elementAdded"))}addElement(n){if(this.has(n))return this;this.add(n);const i=r.getSomeFromDeep(e.elementsMap,n,()=>n instanceof t?{}:{types:new Set});return i.belong&&i.belong.delete(n),i.belong=this,e.combineTypes(this).forEach(r=>{n instanceof t?e.addCallbackToChildren(n,r):e.addCallback(n,r)}),e.fireEvent(new Set([n]),e.addElementEventType,e.managePropagation({},{stopBubbling:!0,stopPropagatingNested:!0})),this}deleteElement(t){return this.delete(t),e.elementsMap.get(t).belong=null,this}addElements(e){return e.forEach(e=>this.addElement(e)),this}clearElements(){return[...this].forEach(e=>this.deleteElement(e)),this}}}setActionOnAddElement(e,t){return this.onAddElementActionsMap.set(e,t),e}static invokePromiseHandle(){let e;return{promise:new Promise(t=>{e=t}),promiseHandle:e}}waitGroupEvent(e,t,n){const{promise:i,promiseHandle:o}=r.invokePromiseHandle();return"string"==typeof t&&this.addCallbackToChildren(e,t),r.getFromDeepMap(this.eventsStore,e).next(t).map.set(n,o),i}fireEvent(e,t,n={}){if(this.applyDefaultPropagation(n),e instanceof Set){let r;(r=e.size>0?[...e]:[{[this.nullKey]:!0,[this.parentKey]:e}]).forEach(e=>{if(!(n[this.propagationKey].stopPropagatingNested&&e instanceof this.RoleSet)){this.queueData.push({target:e,type:t,event:n});const r=this.countTypesInQueue.get(t);this.countTypesInQueue.set(t,r?r+1:1)}}),this.getCallback({[this.nullKey]:!0,[this.parentKey]:this.worker},this.fireFromQueueType)()}else this.getCallback(e,t)(n)}eventChain(e,t){const{roleSet:n,type:r,action:i,typeRegistered:o}=e,s=e.checkIfTerminate||(()=>!1),a={...e,checkIfTerminate:s};o||"string"==typeof r||this.customEventTypes.has(r)||(this.registerEventType(r),a.typeRegistered=!0);let l=t;return t||(l="string"==typeof r?Symbol(`${r}-eventID`):Symbol(`${r.description}-eventID`)),this.waitGroupEvent(n,r,l).then(e=>{const{target:t,event:o}=e;o[this.propagationKey].stopBubbling&&o[this.propagationKey].stopBubbling.has(t)?this.eventChain(a,l):s(e)?this.eventsStore.get(n).get(r).delete(l):(i(e),o[this.propagationKey].stopBubbling&&o[this.propagationKey].stopBubbling.add(t),this.eventChain(a,l))}),t}waitWhenTypeExhausted(e){let t=e;if("onAddElement"===e&&(t=this.addElementEventType),this.countTypesInQueue.get(t)){const{promise:e,promiseHandle:n}=r.invokePromiseHandle();return this.exhaustTypesMap.set(t,n),e}return Promise.resolve()}}const{RoleSet:i,defineRoutine:o,managePropagation:s,stopBubbling:a,stopPropagatingNested:l,setActionOnAddElement:p,fireEvent:d,eventChain:c,waitWhenTypeExhausted:h}=new r;o({interpretTarget:e=>e.node,defaultPropagation:{stopBubbling:!0}});const u=new Map;class f{constructor(e,t,{scaleF:n,zIndex:r}={}){this.node="string"==typeof e?document.createElement(e):e,this.position={scaleF:n||1},this.linked=new Set,this.state={},this.setPosition(t),r&&this.setZIndex(r)}setPosition(e){if(e)for(const t of f.positionPropsNames){const n=e[t];"number"!=typeof n&&null!==n||(this.position[t]=n,this.node.style[t]=n&&`${n*this.position.scaleF}px`)}return this}refreshScaleF(e){for(const t of[this].concat([...this.linked]))t.position.scaleF=e,t.setPosition(t.position);return this}setZIndex(e){return this.node.style["z-index"]=e,this}linkActor(e,t=!0){if(!(e instanceof f))throw new Error("Parameter should be an instance of GameActor class");const{linked:n}=this;return t&&!n.has(e)?(e.refreshScaleF(this.position.scaleF),n.add(e)):!t&&n.has(e)&&n.delete(e),this}remove(){return this.node.remove(),this}getAppendedAsChild(e){if(e instanceof f)e.node.appendChild(this.node);else{if(!(e instanceof i))throw new Error("@@...");[...e][0].node.appendChild(this.node)}return this}attachClassName(e){const{node:t}=this,n=u.get(this);return n&&t.classList.remove(n),t.classList.add(e),u.set(this,e),this}}f.positionPropsNames=["left","top","width","height","bottom","right"];const g=new Map;class y{constructor(e){if("string"==typeof e){const t=g.get(e);if(t)return t;g.set(e,this)}this.type=e}registerAction(e,{action:t}){const n=this,{type:r}=this;let i=!1,o=!1;return new class{constructor(){Object.assign(this,{roleSet:e,type:r,action:t.bind(this),roleClass:n})}start(){if(!i){o=!1;const{roleSet:e,type:t,action:n}=this;c({roleSet:e,type:t,action:n,checkIfTerminate:()=>o}),i=!0}return this}fire(e){return this.roleClass.fire(this.roleSet,e),this}fireAndWaitWhenExhausted(e){return this.roleClass.fireAndWaitWhenExhausted(this.roleSet,e)}stop(){return o=!0,this.fire(),i=!1,this}}}fire(e,t){return d(e,this.type,t),this}fireAndWaitWhenExhausted(e,t){return d(e,this.type,t),h(this.type)}}new y(Symbol("@@ActorSet/initializerClass")),new y(Symbol("@@ActorSet/cleanerClass"));Symbol("@@RolesManipulator/startType"),Symbol("@@RolesManipulator/stopType");let m;onmessage=(({data:{evaluateFps:e}})=>{e?(m=function*(e,t){const n=[];let r=yield null;for(;"number"==typeof r;)if(n.push(r),n.length<e)r=yield null;else{n.length>e&&n.shift();const i=(e-1)/(n[e-1]-n[0])*1e3,o=n.reduce(({min:e,curSeq:n},r)=>{let i,o,s=n.length-1;for(;"number"==typeof n[s]&&r-n[s]<t;)s--;return"number"==typeof n[s]?i=(o=n.slice(s)).length/(r-o[0])*1e3:o=[...n],o.push(r),{min:!i||e&&e<i?e:i,curSeq:o}},{min:null,curSeq:[]}).min;r=yield{averageFPS:i,minFPS:o}}}(63,50)).next():m=null}),setInterval(()=>{postMessage(m&&m.next(performance.now()).value)},16)}});
//# sourceMappingURL=c5e3abec43f7e20038c4.worker.js.map